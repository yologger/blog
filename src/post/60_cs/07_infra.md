---
title: "인프라"
lang: ko
showOnSidebar: true
sidebarDepth: 0
---

# Table of Contents
[[toc]]

## Apache Kafka
- `Publish/Subscribe` 모델의 메시지 큐
- 분산 코디네이터인 `Zookeeper`와 브로커 서버인 `Kafka` 여러 대로 클러스터를 구축할 수 있다.
- `Key-Value` 형식으로 메시지를 전송할 수 있다.
- `Producer`는 메시지를 생산하는 주체
- `Consumer`는 메시지를 소비하는 주체
- 메시지를 `Topic` 단위로 분류한다.
- Topic에 여러 `Partition`을 할당하여 병렬적으로 데이터를 생산할 수 있다.
- `Consumer Group`을 할당하여 배압 이슈를 해결할 수 있다. Consumer Group의 각 `Consumer`는 서로 다른 `Partition`에서 병렬적으로 데이터를 읽어온다.
- 기존 메시지 큐가 인메모리 방식으로 데이터를 저장하는 반면, `Kafka`는 온디스크에 데이터를 저장하기 때문에 영속성이 보장이 된다.
- `Replication`을 활용하여 Topic을 여러 노드에 분산 저장하면 고가용성을 높일 수 있다.

## Docker
- `Docker`는 컨테이너 가상화 기술이다.
- 도커를 사용하면 호스트 OS에 `Container`라는 격리된 공간을 제공받을 수 있다.
- `Docker Container`를 `Docker Image`로 빌드하면 도커가 설치된 어느 곳에든 쉽게 배포할 수 있다.
- 또한 `Kubernetes`같은 컨테이너 오케스트레이션 기술과 함께 사용하여 MSA를 쉽게 구축할 수 있다.
- 가상머신은 게스트 OS와 호스트 OS 사이에 하이퍼바이저가 위치하여 속도가 매우 느리다. 반면 `Docker`는 도커 엔진만을 거쳐 호스트 OS의 자원을 사용하기 때문에 속도가 훨씬 빠르다.

## Kubernetes
- 컨테이너 오케스트레이션 플랫폼으로 여러 물리적 서버를 논리적으로 하나의 서버처럼 클러스터링해준다.
- 쿠버네티스가 오브젝트를 여러 노드에 알아서 분배해서 배치해준다.
- 또한 오토스케일링을 통해 새로운 노드를 쉽게 추가할 수 있어 수평적 확장이 간편하다.
- 그 밖에도 특정 컨테이너가 다운되어도 자동 복구해주는 셀프 힐링
- 요청을 여러 노드와 컨테이너에 골고루 분배해주는 로드 밸런싱
- 무중단 배포를 위한 롤링 업데이트
- 이전 버전으로 쉽게 돌아가는 롤백
- 네트워크, 보안, 볼륨 등 다양한 기능을 제공한다.

### 노드
- 쿠버네티스 클러스터를 구성하는 호스트 하나
- 여러 노드 중 하나를 마스터 노드로 설정하고 나머지를 워커 노드로 설정한다.

### 팟
- 쿠버네티스에서는 컨테이너 애플리케이션의 기본 단위를 팟(Pod)이라고 한다.
- 팟은 하나 이상의 도커 컨테이너로 구성된다.

### 레플리카셋
- 동일한 팟 여러개를 쉽게 생성하고 관리할 수 있다.
- 지정된 팟의 개수를 자동으로 유지하는 셀프 힐링을 제공한다.

### 디플로이먼트
- 여러 팟을 롤링 업데이트하여 무중단 배포가 가능하게 한다.
- 이전 배포로 쉽게 롤백할 수 있다.

### 서비스
- 팟은 기본적으로 쿠버네티스 클러스터 내부에만 노출된다.
- 서비스를 사용하면 팟을 클러스터 외부로 노출시킬 수 있다.

### 네임스페이스
- 여러 오브젝트를 논리적으로 구성할 수 있다.
- 예를 들어 `nginx-ingress`와 관련된 오브젝트는 `nginx-ingress` 네임스페이스에 위치한다.
- `ArgoCD`와 관련된 오브젝트는 `argocd` 네임스페이스에 위치한다.
- 네임스페이스 별로 다른 컨피그 맵과 시크릿을 적용할 수 있다.

### 인그레스
- 팟 외부 노출
- URL Path를 통한 포워딩
- SSL/TLS를 제공하는 오브젝트다.
- 인그레스 컨트롤러를 설치해야한다.