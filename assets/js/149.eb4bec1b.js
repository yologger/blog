(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{1427:function(t,a,s){t.exports=s.p+"assets/img/1.af032386.png"},1743:function(t,a,s){"use strict";s.r(a);var n=s(34),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"table-of-contents"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#table-of-contents"}},[t._v("#")]),t._v(" Table of Contents")]),t._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#elasticsearch"}},[t._v("Elasticsearch")])]),n("li",[n("a",{attrs:{href:"#elk-스택"}},[t._v("ELK 스택")]),n("ul",[n("li",[n("a",{attrs:{href:"#beats"}},[t._v("Beats")])]),n("li",[n("a",{attrs:{href:"#logstash"}},[t._v("Logstash")])]),n("li",[n("a",{attrs:{href:"#elasticsearch"}},[t._v("Elasticsearch")])]),n("li",[n("a",{attrs:{href:"#kibana"}},[t._v("Kibana")])])])]),n("li",[n("a",{attrs:{href:"#elasticsearch-설치"}},[t._v("Elasticsearch 설치")])]),n("li",[n("a",{attrs:{href:"#index"}},[t._v("Index")]),n("ul",[n("li",[n("a",{attrs:{href:"#모든-인덱스-조회"}},[t._v("모든 인덱스 조회")])]),n("li",[n("a",{attrs:{href:"#인덱스-생성"}},[t._v("인덱스 생성")])]),n("li",[n("a",{attrs:{href:"#인덱스-정보-조회"}},[t._v("인덱스 정보 조회")])]),n("li",[n("a",{attrs:{href:"#인덱스-삭제"}},[t._v("인덱스 삭제")])])])]),n("li",[n("a",{attrs:{href:"#document"}},[t._v("Document")]),n("ul",[n("li",[n("a",{attrs:{href:"#도큐먼트-생성"}},[t._v("도큐먼트 생성")])]),n("li",[n("a",{attrs:{href:"#도큐먼트-조회"}},[t._v("도큐먼트 조회")])]),n("li",[n("a",{attrs:{href:"#도큐먼트-업데이트"}},[t._v("도큐먼트 업데이트")])]),n("li",[n("a",{attrs:{href:"#도큐먼트-삭제"}},[t._v("도큐먼트 삭제")])])])]),n("li",[n("a",{attrs:{href:"#벌크-작업"}},[t._v("벌크 작업")])]),n("li",[n("a",{attrs:{href:"#검색"}},[t._v("검색")]),n("ul",[n("li",[n("a",{attrs:{href:"#예제-코드"}},[t._v("예제 코드")])]),n("li",[n("a",{attrs:{href:"#term-쿼리"}},[t._v("Term 쿼리")])]),n("li",[n("a",{attrs:{href:"#match-쿼리"}},[t._v("Match 쿼리")])]),n("li",[n("a",{attrs:{href:"#match-phrase-쿼리"}},[t._v("Match Phrase 쿼리")])])])]),n("li",[n("a",{attrs:{href:"#mapping"}},[t._v("Mapping")]),n("ul",[n("li",[n("a",{attrs:{href:"#매핑-조회"}},[t._v("매핑 조회")])]),n("li",[n("a",{attrs:{href:"#매핑-생성"}},[t._v("매핑 생성")])])])]),n("li",[n("a",{attrs:{href:"#집계"}},[t._v("집계")]),n("ul",[n("li",[n("a",{attrs:{href:"#메트릭-어그리게이션"}},[t._v("메트릭 어그리게이션")]),n("ul",[n("li",[n("a",{attrs:{href:"#평균-계산하기"}},[t._v("평균 계산하기")])]),n("li",[n("a",{attrs:{href:"#최대값-계산하기"}},[t._v("최대값 계산하기")])]),n("li",[n("a",{attrs:{href:"#최소값-계산하기"}},[t._v("최소값 계산하기")])]),n("li",[n("a",{attrs:{href:"#합계-계산하기"}},[t._v("합계 계산하기")])]),n("li",[n("a",{attrs:{href:"#모든-통계-정보"}},[t._v("모든 통계 정보")])])])]),n("li",[n("a",{attrs:{href:"#버킷-어그리게이션"}},[t._v("버킷 어그리게이션")]),n("ul",[n("li",[n("a",{attrs:{href:"#terms-aggregation"}},[t._v("Terms aggregation")])])])])])])])]),n("p"),t._v(" "),n("h2",{attrs:{id:"elasticsearch"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch"}},[t._v("#")]),t._v(" Elasticsearch")]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("Elasticsearch")]),t._v("은 Apache Lucene 기반의 Java 오픈 소스 분산 검색 엔진이다.")])]),t._v(" "),n("li",[n("p",[t._v("관계형 데이터베이스는 행의 위치인 "),n("code",[t._v("인덱스(Index)")]),t._v("를 사용하여 행을 조회한다. 반면 ElasticSearch은 도큐먼트의 문자, 단어 등을 매핑한 "),n("code",[t._v("역색인(Inverted Index)")]),t._v("을 사용하여 데이터를 조회한다. 일반 인덱스는 책 앞 페이지의 목차와 같은 의미이고, 역색인은 책 뒷 편의 단어 별 빠른 페이지와 같다.")])]),t._v(" "),n("li",[n("p",[t._v("인덱스를 통한 검색은 인덱스를 순차검색 하기 때문에 "),n("code",[t._v("O(n)")]),t._v(" 또는  "),n("code",[t._v("O(logn)")]),t._v("의 시간 복잡도를 갖는다. 반면 역색인은 마치 해시함수와 같아서 "),n("code",[t._v("O(1)")]),t._v("의 시간 복잡도를 갖는다. 이 때문에 ElasticSearch은 빠른 검색에 사용된다.")])]),t._v(" "),n("li",[n("p",[t._v("ElasticSearch는 스키마가 없기 때문에 NoSQL처럼 비정형 데이터를 저장할 수 있다. 물론 "),n("code",[t._v("Mapping")]),t._v("을 사용하면 스키마를 설정할 수도 있다.")])]),t._v(" "),n("li",[n("p",[t._v("ElasticSearch는 기본적으로 REST API에 HTTP 요청을 보내는 형태로 데이터를 조작한다.")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("RDBMS")]),t._v(" "),n("th",[t._v("Elastic Search")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("SELECT")]),t._v(" "),n("td",[t._v("GET")])]),t._v(" "),n("tr",[n("td",[t._v("UPDATE")]),t._v(" "),n("td",[t._v("PUT")])]),t._v(" "),n("tr",[n("td",[t._v("INSERT")]),t._v(" "),n("td",[t._v("POST")])]),t._v(" "),n("tr",[n("td",[t._v("DELETE")]),t._v(" "),n("td",[t._v("DELETE")])])])])])]),t._v(" "),n("h2",{attrs:{id:"elk-스택"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#elk-스택"}},[t._v("#")]),t._v(" ELK 스택")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("Elasticsearch")]),t._v("은 빠른 검색을 위해 단독으로 사용되기도 하지만 "),n("code",[t._v("ELK(Elasticsearch / LogStash / Kibana)")]),t._v(" + "),n("code",[t._v("Beats")]),t._v(" 스택으로 사용되기도 한다.")]),t._v(" "),n("li",[t._v("ELK 스택을 사용하면 여러 데이터소스에서 발생한 데이터를 수집, 가공, 분석한 후 시각화할 수 있다.")]),t._v(" "),n("li",[t._v("ELK 스택은 MSA 환경에서 여러 개별 서비스의 로그를 중앙 집중형 로깅하고 모니터링하는데 사용할 수 있다.")]),t._v(" "),n("li",[t._v("빅데이터 분야에도 활용할 수 있다.")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1427),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"beats"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#beats"}},[t._v("#")]),t._v(" Beats")]),t._v(" "),n("ul",[n("li",[t._v("여러 데이터 소스에 설치되어 데이터를 수집한 후 Logstash로 전송한다.")])]),t._v(" "),n("h3",{attrs:{id:"logstash"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#logstash"}},[t._v("#")]),t._v(" Logstash")]),t._v(" "),n("ul",[n("li",[t._v("데이터 소스의 데이터를 실시간으로 수집하여 Elastic Search로 전달하는 파이프 라인 엔진이다.")]),t._v(" "),n("li",[t._v("여러 데이터 소스로부터 발생하는 데이터를 적절하게 변환한다.")])]),t._v(" "),n("h3",{attrs:{id:"elasticsearch-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-2"}},[t._v("#")]),t._v(" Elasticsearch")]),t._v(" "),n("ul",[n("li",[t._v("Logstash를 통해 수신된 데이터를 저장소에 저장하는 역할을 담당한다.")]),t._v(" "),n("li",[t._v("역인덱싱을 통한 빠른 검색을 제공한다.")]),t._v(" "),n("li",[t._v("어그리게이션 등을 통한 데이터 가공 및 분석 기능을 제공한다.")])]),t._v(" "),n("h3",{attrs:{id:"kibana"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#kibana"}},[t._v("#")]),t._v(" Kibana")]),t._v(" "),n("ul",[n("li",[t._v("ElasticSearch에 저장된 데이터를 시각화한다.")])]),t._v(" "),n("h2",{attrs:{id:"elasticsearch-설치"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-설치"}},[t._v("#")]),t._v(" Elasticsearch 설치")]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("Information")]),t._v(" "),n("p",[t._v("ElasticSearch 7.17.4 버전을 기준으로 합니다.")])]),t._v(" "),n("p",[t._v("Mac OS 환경에서는 Homebrew로 쉽게 설치할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ brew install elastic/tap/elasticsearch-full\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ brew info elastic/tap/elasticsearch-full\nelastic/tap/elasticsearch-full: stable 7.17.4\nDistributed search & analytics engine\nhttps://www.elastic.co/products/elasticsearch\nConflicts with:\n  elasticsearch\n/usr/local/Cellar/elasticsearch-full/7.17.4 (946 files, 476.2MB) *\n  Built from source on 2022-06-07 at 03:21:58\nFrom: https://github.com/elastic/homebrew-tap/blob/HEAD/Formula/elasticsearch-full.rb\n==> Caveats\nData:    /usr/local/var/lib/elasticsearch/elasticsearch_hyukjung/\nLogs:    /usr/local/var/log/elasticsearch/elasticsearch_hyukjung.log\nPlugins: /usr/local/var/elasticsearch/plugins/\nConfig:  /usr/local/etc/elasticsearch/ \n")])])]),n("p",[t._v("설치가 완료되었다면 다음과 같이 시작할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ brew services start elastic/tap/elasticsearch-full\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ brew services list\nName                  Status  User     File\nelasticsearch-full    started yologger ~/Library/LaunchAgents/homebrew.mxcl.elasticsearch-full.plist\n")])])]),n("p",[t._v("참고로 다음과 같이 Elastic Search를 종료할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ brew services stop elastic/tap/elasticsearch-full\n")])])]),n("h2",{attrs:{id:"index"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#index"}},[t._v("#")]),t._v(" Index")]),t._v(" "),n("p",[n("code",[t._v("인덱스(Index)")]),t._v("는 관계형 데이터베이스의 데이터베이스에 상응한다.")]),t._v(" "),n("h3",{attrs:{id:"모든-인덱스-조회"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#모든-인덱스-조회"}},[t._v("#")]),t._v(" 모든 인덱스 조회")]),t._v(" "),n("p",[t._v("모든 인덱스는 다음과 같이 조회할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XGET http://localhost:9200/_cat/indices?v\nhealth status index                           uuid                   pri rep docs.count docs.deleted store.size pri.store.size\ngreen  open   .geoip_databases                SulDhHIrS0m9Saj_8dDmiw   1   0         40           37     38.2mb         38.2mb\ngreen  open   .apm-custom-link                RnYiMMZaQG2-wIGVOOHO9g   1   0          0            0       226b           226b\ngreen  open   .apm-agent-configuration        dZ38RFD3TxeX1i5Qew_iag   1   0          0            0       226b           226b\ngreen  open   .kibana_task_manager_7.17.4_001 v9bQStFQQwirWPuyzHcXSA   1   0         17        63369      7.1mb          7.1mb\ngreen  open   .kibana_7.17.4_001              NJda68wDRoOK213SMSOuXQ   1   0        316           24      2.4mb          2.4mb\ngreen  open   .tasks                          TChPhQP_RymhB-xr0TdxuQ   1   0          4            0     27.4kb         27.4kb\n")])])]),n("h3",{attrs:{id:"인덱스-생성"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#인덱스-생성"}},[t._v("#")]),t._v(" 인덱스 생성")]),t._v(" "),n("p",[t._v("다음과 같이 인덱스를 생성할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XPUT http://localhost:9200/<INDEX_NAME>\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPUT http://localhost:9200/person\n{"acknowledged":true,"shards_acknowledged":true,"index":"person"}\n')])])]),n("h3",{attrs:{id:"인덱스-정보-조회"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#인덱스-정보-조회"}},[t._v("#")]),t._v(" 인덱스 정보 조회")]),t._v(" "),n("p",[t._v("다음과 같이 인덱스에 대한 정보를 조회할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XGET http://localhost:9200/<INDEX_NAME>\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/person\n{"person":{"aliases":{},"mappings":{},"settings":{"index":{"routing":{"allocation":{"include":{"_tier_preference":"data_content"}}},"number_of_shards":"1","provided_name":"person","creation_date":"1654690323178","number_of_replicas":"1","uuid":"b-Lm10C-RBOqo8JlYSqw8A","version":{"created":"7170499"}}}}}\n')])])]),n("p",[t._v("인덱스가 없다면 다음과 같은 오류가 발생한다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{"error":{"root_cause":[{"type":"index_not_found_exception","reason":"no such index [person]","resource.type":"index_or_alias","resource.id":"person","index_uuid":"_na_","index":"person"}],"type":"index_not_found_exception","reason":"no such index [person]","resource.type":"index_or_alias","resource.id":"person","index_uuid":"_na_","index":"person"},"status":404}\n')])])]),n("p",[n("code",[t._v("pretty")]),t._v(" 옵션으로 결과값을 예쁘게 출력할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XGET http://localhost:9200/person?pretty\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "person" : {\n    "aliases" : { },\n    "mappings" : { },\n    "settings" : {\n      "index" : {\n        "routing" : {\n          "allocation" : {\n            "include" : {\n              "_tier_preference" : "data_content"\n            }\n          }\n        },\n        "number_of_shards" : "1",\n        "provided_name" : "person",\n        "creation_date" : "1654690323178",\n        "number_of_replicas" : "1",\n        "uuid" : "b-Lm10C-RBOqo8JlYSqw8A",\n        "version" : {\n          "created" : "7170499"\n        }\n      }\n    }\n  }\n}\n')])])]),n("h3",{attrs:{id:"인덱스-삭제"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#인덱스-삭제"}},[t._v("#")]),t._v(" 인덱스 삭제")]),t._v(" "),n("p",[t._v("다음과 같이 인덱스를 삭제할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XDELETE http://localhost:9200/person\n{"acknowledged":true}\n')])])]),n("h2",{attrs:{id:"document"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#document"}},[t._v("#")]),t._v(" Document")]),t._v(" "),n("h3",{attrs:{id:"도큐먼트-생성"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#도큐먼트-생성"}},[t._v("#")]),t._v(" 도큐먼트 생성")]),t._v(" "),n("p",[t._v("도큐먼트를 생성할 때는 HTTP PUT 메소드를 사용한다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XPUT http://localhost:9200/<INDEX>/_doc/<DOCUMENT_ID> \\ \n- H 'Content-Type: application/json' \\\n- d '{\"key\": \"value\"}' \n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPUT http://localhost:9200/player/_doc/1?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'{"name": "messi", "nation": "argentina"}\'\n')])])]),n("p",[t._v("도큐먼트 생성에 성공하면 "),n("code",[t._v('"result" : "created"')]),t._v("가 표시된다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "_index" : "player",\n  "_type" : "_doc",\n  "_id" : "1",\n  "_version" : 1,\n  "result" : "created",\n  "_shards" : {\n    "total" : 2,\n    "successful" : 1,\n    "failed" : 0\n  },\n  "_seq_no" : 0,\n  "_primary_term" : 1\n}\n')])])]),n("p",[t._v("동일한 URL에 다른 도큐먼트를 입력하면 기존 도큐먼트를 덮어쓰게 되며 "),n("code",[t._v('"result" : "updated"')]),t._v('가 표시된다. 또한 "_version"의 값이 1 증가한다.')]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPUT http://localhost:9200/player/_doc/1?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'{"name": "ronaldo", "nation": "portugal"}\'\n')])])]),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "_index" : "player",\n  "_type" : "_doc",\n  "_id" : "1",\n  "_version" : 2,\n  "result" : "updated",\n  "_shards" : {\n    "total" : 2,\n    "successful" : 1,\n    "failed" : 0\n  },\n  "_seq_no" : 1,\n  "_primary_term" : 1\n}\n')])])]),n("p",[t._v("도큐먼트는 JSON 파일을 사용하여 생성할 수도 있다.")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// player.json")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"benzema"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"france"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XPOST http://localhost:9200/player/_doc/3 \\\n-H 'Content-Type: application/json' \\\n-d @player.json\n")])])]),n("p",[t._v("ID 없이 도큐먼트를 생성하면 ID가 자동으로 생성된다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPOST http://localhost:9200/player/_doc?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'{"name": "neymar", "nation": "brazil"}\'\n')])])]),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "_index" : "player",\n  "_type" : "_doc",\n  "_id" : "QCFIQ4EBhCK0-IfWXiwB",\n  "_version" : 1,\n  "result" : "created",\n  "_shards" : {\n    "total" : 2,\n    "successful" : 1,\n    "failed" : 0\n  },\n  "_seq_no" : 2,\n  "_primary_term" : 1\n}\n')])])]),n("p",[t._v("실수로 기존 도큐먼트가 덮어씌워지는 것을 방지하기 위해 "),n("code",[t._v("_doc")]),t._v(" 대신 "),n("code",[t._v("_create")]),t._v("를 사용하여 도큐먼트를 생성할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPOST http://localhost:9200/player/_create/1?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'{"name": "kane", "nation": "england"}\'\n')])])]),n("p",[t._v("도큐먼트가 이미 존재하는 경우 다음 에러가 발생한다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "error" : {\n    "root_cause" : [\n      {\n        "type" : "version_conflict_engine_exception",\n        "reason" : "[1]: version conflict, document already exists (current version [2])",\n        "index_uuid" : "wIiKCmHQSYijirqahH_tpw",\n        "shard" : "0",\n        "index" : "player"\n      }\n    ],\n    "type" : "version_conflict_engine_exception",\n    "reason" : "[1]: version conflict, document already exists (current version [2])",\n    "index_uuid" : "wIiKCmHQSYijirqahH_tpw",\n    "shard" : "0",\n    "index" : "player"\n  },\n  "status" : 409\n}\n')])])]),n("h3",{attrs:{id:"도큐먼트-조회"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#도큐먼트-조회"}},[t._v("#")]),t._v(" 도큐먼트 조회")]),t._v(" "),n("p",[t._v("도큐먼트를 조회할 때는 HTTP GET 메서드를 사용한다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XGET http://localhost:9200/player/_doc/1?pretty\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "_index" : "player",\n  "_type" : "_doc",\n  "_id" : "1",\n  "_version" : 2,\n  "_seq_no" : 1,\n  "_primary_term" : 1,\n  "found" : true,\n  "_source" : {\n    "name" : "ronaldo",\n    "nation" : "portugal"\n  }\n}\n')])])]),n("h3",{attrs:{id:"도큐먼트-업데이트"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#도큐먼트-업데이트"}},[t._v("#")]),t._v(" 도큐먼트 업데이트")]),t._v(" "),n("p",[t._v("다음과 같은 도큐먼트가 있다고 하자.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XGET http://localhost:9200/player/_doc/1?pretty\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "_index" : "player",\n  "_type" : "_doc",\n  "_id" : "1",\n  "_version" : 2,\n  "_seq_no" : 1,\n  "_primary_term" : 1,\n  "found" : true,\n  "_source" : {\n    "name" : "ronaldo",\n    "nation" : "portugal"\n  }\n}\n')])])]),n("p",[t._v("URL 뒤에 "),n("code",[t._v("_update")]),t._v("을 붙이면 특정 필드만 업데이트할 수 있다. Request Body에는 "),n("code",[t._v("doc")]),t._v(" 키를 통해 변경할 내용을 전달한다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPOST http://localhost:9200/player/_update/1?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'{"doc": {"name": "pepe"}}\'\n')])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/player/_doc/1\\?pretty\n{\n  "_index" : "player",\n  "_type" : "_doc",\n  "_id" : "1",\n  "_version" : 3,\n  "_seq_no" : 3,\n  "_primary_term" : 1,\n  "found" : true,\n  "_source" : {\n    "name" : "pepe",\n    "nation" : "portugal"\n  }\n}\n')])])]),n("p",[t._v("특정 필드를 추가할 수도 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPOST http://localhost:9200/player/_update/1?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'{"doc": {"team": "real madrid"}}\'\n')])])]),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/player/_doc/1?pretty\n{\n  "_index" : "player",\n  "_type" : "_doc",\n  "_id" : "1",\n  "_version" : 4,\n  "_seq_no" : 4,\n  "_primary_term" : 1,\n  "found" : true,\n  "_source" : {\n    "name" : "pepe",\n    "nation" : "portugal",\n    "team" : "real madrid"\n  }\n}\n')])])]),n("p",[n("code",[t._v("doc")]),t._v(" 대신 "),n("code",[t._v("script")]),t._v(" 키를 통해 계산식을 사용할 수도 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XPOST http://localhost:9200/person/player/2/_update \\\n-H 'Content-Type: application/json' \\\n-d '{\"script\": \"ctx._source.age += 5\"}'\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/person/player/2\\?pretty\n{\n  "_index" : "person",\n  "_type" : "player",\n  "_id" : "2",\n  "_version" : 6,\n  "_seq_no" : 6,\n  "_primary_term" : 1,\n  "found" : true,\n  "_source" : {\n    "name" : "Smith",\n    "nation" : "UK",\n    "team" : "real madrid",\n    "age" : 40\n  }\n}\n')])])]),n("h3",{attrs:{id:"도큐먼트-삭제"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#도큐먼트-삭제"}},[t._v("#")]),t._v(" 도큐먼트 삭제")]),t._v(" "),n("p",[t._v("HTTP DELETE 메소드로 도큐먼트를 삭제할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XDELETE http://localhost:9200/player/_doc/1?pretty\n{\n  "_index":"player",\n  "_type":"_doc",\n  "_id":"1",\n  "_version":5,\n  "result":"deleted",\n  "_shards":{\n    "total":2,\n    "successful":1,\n    "failed":0\n  },\n  "_seq_no":5,\n  "_primary_term":1\n} \n')])])]),n("h2",{attrs:{id:"벌크-작업"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#벌크-작업"}},[t._v("#")]),t._v(" 벌크 작업")]),t._v(" "),n("p",[t._v("ElasticSearch는 벌크 작업도 지원한다.")]),t._v(" "),n("p",[t._v("JSON 파일로 벌크 INSERT 작업을 수행해보자.")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// players.json")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"player"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ronaldo"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"portugal"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("37")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"assist"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"player"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"son"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"south korea"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"assist"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"player"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"salah"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"egypt"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"assist"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"player"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"benzema"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"france"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("36")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"assist"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"player"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ebappe"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"france"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"assist"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"player"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pogba"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"france"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"assist"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"player"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"7"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kane"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"england"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"assist"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"player"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fernandes"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"portugal"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"assist"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[n("code",[t._v("--data-binary")]),t._v("옵션을 사용하면 된다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XPOST http://localhost:9200/player/_bulk \\\n-H 'Content-Type: application/json' \\\n--data-binary @players.json\n")])])]),n("h2",{attrs:{id:"검색"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#검색"}},[t._v("#")]),t._v(" 검색")]),t._v(" "),n("p",[t._v("URL 뒤에 "),n("code",[t._v("_search")]),t._v("를 붙여 도큐먼트를 검색할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XGET http://localhost:9200/player/_search\\?pretty\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "took" : 0,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 8,\n      "relation" : "eq"\n    },\n    "max_score" : 1.0,\n    "hits" : [\n      {\n        "_index" : "player",\n        "_type" : "_doc",\n        "_id" : "1",\n        "_score" : 1.0,\n        "_source" : {\n          "name" : "ronaldo",\n          "nation" : "portugal",\n          "age" : 37,\n          "score" : 15,\n          "assist" : 15\n        }\n      },\n      {\n        "_index" : "player",\n        "_type" : "_doc",\n        "_id" : "2",\n        "_score" : 1.0,\n        "_source" : {\n          "name" : "son",\n          "nation" : "south korea",\n          "age" : 31,\n          "score" : 20,\n          "assist" : 13\n        }\n      },\n      {\n        "_index" : "player",\n        "_type" : "_doc",\n        "_id" : "3",\n        "_score" : 1.0,\n        "_source" : {\n          "name" : "salah",\n          "nation" : "egypt",\n          "age" : 31,\n          "score" : 19,\n          "assist" : 11\n        }\n      },\n      {\n        "_index" : "player",\n        "_type" : "_doc",\n        "_id" : "4",\n        "_score" : 1.0,\n        "_source" : {\n          "name" : "benzema",\n          "nation" : "france",\n          "age" : 36,\n          "score" : 27,\n          "assist" : 11\n        }\n      },\n      {\n        "_index" : "player",\n        "_type" : "_doc",\n        "_id" : "5",\n        "_score" : 1.0,\n        "_source" : {\n          "name" : "ebappe",\n          "nation" : "france",\n          "age" : 25,\n          "score" : 25,\n          "assist" : 7\n        }\n      },\n      {\n        "_index" : "player",\n        "_type" : "_doc",\n        "_id" : "6",\n        "_score" : 1.0,\n        "_source" : {\n          "name" : "pogba",\n          "nation" : "france",\n          "age" : 31,\n          "score" : 8,\n          "assist" : 20\n        }\n      },\n      {\n        "_index" : "player",\n        "_type" : "_doc",\n        "_id" : "7",\n        "_score" : 1.0,\n        "_source" : {\n          "name" : "kane",\n          "nation" : "england",\n          "age" : 30,\n          "score" : 12,\n          "assist" : 18\n        }\n      },\n      {\n        "_index" : "player",\n        "_type" : "_doc",\n        "_id" : "8",\n        "_score" : 1.0,\n        "_source" : {\n          "name" : "fernandes",\n          "nation" : "portugal",\n          "age" : 28,\n          "score" : 10,\n          "assist" : 16\n        }\n      }\n    ]\n  }\n}\n')])])]),n("p",[t._v("조건을 쿼리 파라미터 형태로 전달할 수 있다. "),n("code",[t._v("_search")]),t._v(" 뒤에 "),n("code",[t._v("q")]),t._v(" 파라미터를 추가하면 된다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XGET http://localhost:9200/player/_search?q=age:36&pretty\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "took" : 0,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 1,\n      "relation" : "eq"\n    },\n    "max_score" : 1.0,\n    "hits" : [\n      {\n        "_index" : "player",\n        "_type" : "_doc",\n        "_id" : "4",\n        "_score" : 1.0,\n        "_source" : {\n          "name" : "benzema",\n          "nation" : "france",\n          "age" : 36,\n          "score" : 27,\n          "assist" : 11\n        }\n      }\n    ]\n  }\n}\n')])])]),n("p",[t._v("조건을 HTTP request body 형태로 전달할 수도 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/player/_search\\?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'{ "query": { "match": {"name": "kane"} }}\'\n')])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "took" : 0,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 1,\n      "relation" : "eq"\n    },\n    "max_score" : 1.7917595,\n    "hits" : [\n      {\n        "_index" : "player",\n        "_type" : "_doc",\n        "_id" : "7",\n        "_score" : 1.7917595,\n        "_source" : {\n          "name" : "kane",\n          "nation" : "england",\n          "age" : 30,\n          "score" : 12,\n          "assist" : 18\n        }\n      }\n    ]\n  }\n}\n')])])]),n("p",[t._v("다양한 검색 옵션을 좀 더 알아보자.")]),t._v(" "),n("h3",{attrs:{id:"예제-코드"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#예제-코드"}},[t._v("#")]),t._v(" 예제 코드")]),t._v(" "),n("p",[t._v("예제를 위한 데이터는 다음과 같다.")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"content"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello world"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"content"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello world nice to meet you"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"content"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello world see you again"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"content"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"see you again good bye"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"content"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"good bye have a nice day"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_index"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"content"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello world nice to meet you good bye have a nice day"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XPOST http://localhost:9200/post/_bulk \\\n-H 'Content-Type: application/json' \\\n--data-binary @posts.json\n")])])]),n("h3",{attrs:{id:"term-쿼리"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#term-쿼리"}},[t._v("#")]),t._v(" Term 쿼리")]),t._v(" "),n("p",[n("code",[t._v("Term 쿼리")]),t._v("는 검색어에 대한 분석을 하지않고 온전히 그 검색어와 일치하는 문서를 검색한다. 아래 예제에서는 정확히 "),n("code",[t._v("again")]),t._v("을 포함한 도큐먼트만 결과물로 출력한다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/post/_search?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'\n{\n  "query": {\n    "term": {\n      "content": "again"\n    }\n  }\n}\n\'\n')])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "took" : 0,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 2,\n      "relation" : "eq"\n    },\n    "max_score" : 1.1049575,\n    "hits" : [\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "3",\n        "_score" : 1.1049575,\n        "_source" : {\n          "content" : "hello world see you again"\n        }\n      },\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "4",\n        "_score" : 1.1049575,\n        "_source" : {\n          "content" : "see you again good bye"\n        }\n      }\n    ]\n  }\n}\n')])])]),n("h3",{attrs:{id:"match-쿼리"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#match-쿼리"}},[t._v("#")]),t._v(" Match 쿼리")]),t._v(" "),n("p",[t._v("Term 쿼리가 완전히 정확한 검색이라면 "),n("code",[t._v("Match 쿼리")]),t._v("는 다소 모호한 검색이다. 예를 들어 여러 도큐먼트에 "),n("code",[t._v("do")]),t._v(", "),n("code",[t._v("done")]),t._v(", "),n("code",[t._v("doing")]),t._v("의 단어가 포함되어있고 용어(Term)에 "),n("code",[t._v("do")]),t._v("가 등록되어있다면 "),n("code",[t._v("do")]),t._v(" 뿐만 아니라 "),n("code",[t._v("done")]),t._v(", "),n("code",[t._v("doing")]),t._v("을 포함하는 도큐먼트도 검색해준다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/post/_search?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'\n{\n  "query": {\n    "match": {\n      "content": "hello"\n    }\n  }\n}\n\'\n')])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "took" : 0,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 4,\n      "relation" : "eq"\n    },\n    "max_score" : 0.60752,\n    "hits" : [\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "1",\n        "_score" : 0.60752,\n        "_source" : {\n          "content" : "hello world"\n        }\n      },\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "3",\n        "_score" : 0.47416198,\n        "_source" : {\n          "content" : "hello world see you again"\n        }\n      },\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "2",\n        "_score" : 0.44183272,\n        "_source" : {\n          "content" : "hello world nice to meet you"\n        }\n      },\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "6",\n        "_score" : 0.3135587,\n        "_source" : {\n          "content" : "hello world nice to meet you good bye have a nice day"\n        }\n      }\n    ]\n  }\n}\n')])])]),n("p",[n("code",[t._v("match")]),t._v(" 검색에 여러 개의 검색어를 넣으면 OR 조건으로 검색을 한다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/post/_search?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'\n{\n  "query": {\n    "match": {\n      "content": "hello nice"\n    }\n  }\n}\n\'\n')])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "query": {\n    "match": {\n      "content": "hello nice"\n    }\n  }\n}\n\'\n{\n  "took" : 40,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 5,\n      "relation" : "eq"\n    },\n    "max_score" : 1.1349798,\n    "hits" : [\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "2",\n        "_score" : 1.1349798,\n        "_source" : {\n          "content" : "hello world nice to meet you"\n        }\n      },\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "6",\n        "_score" : 1.057424,\n        "_source" : {\n          "content" : "hello world nice to meet you good bye have a nice day"\n        }\n      },\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "5",\n        "_score" : 0.6931471,\n        "_source" : {\n          "content" : "good bye have a nice day"\n        }\n      },\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "1",\n        "_score" : 0.60752,\n        "_source" : {\n          "content" : "hello world"\n        }\n      },\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "3",\n        "_score" : 0.47416198,\n        "_source" : {\n          "content" : "hello world see you again"\n        }\n      }\n    ]\n  }\n}\n')])])]),n("p",[t._v("다음과 같이 AND 조건으로 검색할 수도 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/post/_search?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'\n{\n  "query": {\n    "match": {\n      "content": "hello nice",\n\t\t"operator": "and"\n    }\n  }\n}\n\'\n')])])]),n("h3",{attrs:{id:"match-phrase-쿼리"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#match-phrase-쿼리"}},[t._v("#")]),t._v(" Match Phrase 쿼리")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/post/_search?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'\n{\n  "query": {\n    "match_phrase": {\n      "content": "again good"\n    }\n  }\n}\n\'\n')])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "took" : 56,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 1,\n      "relation" : "eq"\n    },\n    "max_score" : 1.8488227,\n    "hits" : [\n      {\n        "_index" : "post",\n        "_type" : "_doc",\n        "_id" : "4",\n        "_score" : 1.8488227,\n        "_source" : {\n          "content" : "see you again good bye"\n        }\n      }\n    ]\n  }\n}\n')])])]),n("h2",{attrs:{id:"mapping"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mapping"}},[t._v("#")]),t._v(" Mapping")]),t._v(" "),n("p",[t._v("ElasticSearch는 자유로운 형태로 도큐먼트를 추가할 수 있다. 그러나 "),n("code",[t._v("매핑(Mapping)")]),t._v("을 사용하면 관계형 데이터베이스의 스키마처럼 형식을 강제할 수 있다.")]),t._v(" "),n("p",[t._v("ElasticSearch는 별도의 매핑을 정의하지 않아도 도큐먼트를 새로 추가할 때 매핑이 자동으로 생성된다. 다음과 같이 도큐먼트를 추가하면")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPOST http://localhost:9200/player/_doc/1 \\\n-H \'Content-Type: application/json\' \\\n-d \'{"name": "ronaldo", "nation": "portugal", "age": 37, "score": 15, "assist": 15}\'\n')])])]),n("p",[t._v("다음과 같이 매핑이 자동으로 생성된다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XGET http://localhost:9200/player/_mapping?pretty\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "player" : {\n    "mappings" : {\n      "properties" : {\n        "age" : {\n          "type" : "long"\n        },\n        "assist" : {\n          "type" : "long"\n        },\n        "name" : {\n          "type" : "text",\n          "fields" : {\n            "keyword" : {\n              "type" : "keyword",\n              "ignore_above" : 256\n            }\n          }\n        },\n        "nation" : {\n          "type" : "text",\n          "fields" : {\n            "keyword" : {\n              "type" : "keyword",\n              "ignore_above" : 256\n            }\n          }\n        },\n        "score" : {\n          "type" : "long"\n        }\n      }\n    }\n  }\n}\n')])])]),n("h3",{attrs:{id:"매핑-조회"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#매핑-조회"}},[t._v("#")]),t._v(" 매핑 조회")]),t._v(" "),n("p",[t._v("URL 뒤에 "),n("code",[t._v("_mapping")]),t._v("을 붙여 인덱스의 매핑을 확인할 수 있다. 매핑이 없다면 다음과 같이 출력된다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XPUT http://localhost:9200/post\n\n$ curl -XGET http://localhost:9200/post/_mapping\\?pretty\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "post" : {\n    "mappings" : { }\n  }\n}\n')])])]),n("h3",{attrs:{id:"매핑-생성"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#매핑-생성"}},[t._v("#")]),t._v(" 매핑 생성")]),t._v(" "),n("p",[t._v("인덱스를 생성할 때 매핑을 함께 정의할 수 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPUT http://localhost:9200/person \\\n-H \'Content-Type: application/json\' \\\n-d \'\n{\n  "mappings": {\n    "properties": {\n      "name": { "type": "text"  },   \n      "age": { "type": "integer" }\n    }\n  }  \n}\n\'\n')])])]),n("p",[t._v("이미 매핑이 존재할 때 필드를 추가할 수도 있다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPUT http://localhost:9200/person/_mapping \\\n-H \'Content-Type: application/json\' \\\n-d \'\n{\n  "properties": {\n    "nation": { "type": "text"  }\n  }\n}\n\'\n')])])]),n("p",[t._v("매핑을 확인해보자.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XGET http://localhost:9200/person/_mapping\\?pretty\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "person" : {\n    "mappings" : {\n      "properties" : {\n        "age" : {\n          "type" : "integer"\n        },\n        "name" : {\n          "type" : "text"\n        },\n        "nation" : {\n          "type" : "text"\n        }\n      }\n    }\n  }\n}\n')])])]),n("p",[t._v("이제 매핑에 맞는 형식으로 도큐먼트를 추가해야한다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XPUT http://localhost:9200/player/_doc/1?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'{"name": "paul", "nation": "usa", "age": "35"}\'\n')])])]),n("p",[t._v("매핑에 맞지 않는 형식으로 도큐먼트를 추가하면 에러가 발생한다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('curl -XPUT http://localhost:9200/player/_doc/4?pretty \\\n-H \'Content-Type: application/json\' \\\n-d \'{"name": "paul", "nation": "usa", "age": "hello world"}\'\n')])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n  "error" : {\n    "root_cause" : [\n      {\n        "type" : "mapper_parsing_exception",\n        "reason" : "failed to parse field [age] of type [long] in document with id \'4\'. Preview of field\'s value: \'hello world\'"\n      }\n    ],\n    "type" : "mapper_parsing_exception",\n    "reason" : "failed to parse field [age] of type [long] in document with id \'4\'. Preview of field\'s value: \'hello world\'",\n    "caused_by" : {\n      "type" : "illegal_argument_exception",\n      "reason" : "For input string: \\"hello world\\""\n    }\n  },\n  "status" : 400\n}\n')])])]),n("h2",{attrs:{id:"집계"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#집계"}},[t._v("#")]),t._v(" 집계")]),t._v(" "),n("p",[n("code",[t._v("집계(Aggregation)")]),t._v("은 모든 데이터의 분석 및 요약을 제공하는 기능이다. 관계형 데이터베이스의 "),n("code",[t._v("Grouping")]),t._v(", "),n("code",[t._v("Project")]),t._v("에 상응한다.")]),t._v(" "),n("p",[t._v("어그리게이션 예제를 위한 테스트 데이터는 다음과 같다.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{ "index" : { "_index" : "person", "_type" : "player", "_id" : "1" } }\n{"name": "ronaldo", "nation": "portugal", "age": 37, "score": 15, "assist": 15}\n{ "index" : { "_index" : "person", "_type" : "player", "_id" : "2" } }\n{"name": "son", "nation": "south korea", "age": 31, "score": 20, "assist": 13}\n{ "index" : { "_index" : "person", "_type" : "player", "_id" : "3" } }\n{"name": "salah", "nation": "egypt", "age": 31, "score": 19, "assist": 11}\n{ "index" : { "_index" : "person", "_type" : "player", "_id" : "4" } }\n{"name": "benzema", "nation": "france", "age": 36, "score": 27, "assist": 11}\n{ "index" : { "_index" : "person", "_type" : "player", "_id" : "5" } }\n{"name": "ebappe", "nation": "france", "age": 25, "score": 25, "assist": 7}\n{ "index" : { "_index" : "person", "_type" : "player", "_id" : "6" } }\n{"name": "pogba", "nation": "france", "age": 31, "score": 8, "assist": 20}\n{ "index" : { "_index" : "person", "_type" : "player", "_id" : "7" } }\n{"name": "kane", "nation": "england", "age": 30, "score": 12, "assist": 18}\n{ "index" : { "_index" : "person", "_type" : "player", "_id" : "8" } }\n{"name": "fernandes", "nation": "portugal", "age": 28, "score": 10, "assist": 16}\n')])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XPOST http://localhost:9200/_bulk? \\\n-H 'Content-Type: application/json' \\\n--data-binary @players.json\n")])])]),n("h3",{attrs:{id:"메트릭-어그리게이션"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#메트릭-어그리게이션"}},[t._v("#")]),t._v(" 메트릭 어그리게이션")]),t._v(" "),n("p",[t._v("산술이나 통계에 대한 어그리게이션을 "),n("code",[t._v("메트릭 어그리게이션")]),t._v("이라고 한다.")]),t._v(" "),n("h4",{attrs:{id:"평균-계산하기"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#평균-계산하기"}},[t._v("#")]),t._v(" 평균 계산하기")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// avg_score.json")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"size"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"aggs"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"avg_score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"avg"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"field"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"score"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/_search\\?pretty \\\n-H \'Content-Type: application/json\' \\\n--data-binary @avg_score.json\n{\n  "took" : 409,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 8,\n      "relation" : "eq"\n    },\n    "max_score" : null,\n    "hits" : [ ]\n  },\n  "aggregations" : {\n    "avg_score" : {\n      "value" : 17.0\n    }\n  }\n}\n')])])]),n("h4",{attrs:{id:"최대값-계산하기"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#최대값-계산하기"}},[t._v("#")]),t._v(" 최대값 계산하기")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// max_score.json")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"size"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"aggs"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"max_score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"max"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"field"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"score"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"최소값-계산하기"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#최소값-계산하기"}},[t._v("#")]),t._v(" 최소값 계산하기")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// min_score.json")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"size"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"aggs"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"min_score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"min"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"field"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"score"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"합계-계산하기"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#합계-계산하기"}},[t._v("#")]),t._v(" 합계 계산하기")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// sum_score.json")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"size"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"aggs"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sum_score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sum"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"field"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"score"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"모든-통계-정보"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#모든-통계-정보"}},[t._v("#")]),t._v(" 모든 통계 정보")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// stats_score.json")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"size"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"aggs"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"stats_score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"stats"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"field"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"score"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language- extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/_search\\?pretty \\\n-H \'Content-Type: application/json\' \\\n--data-binary @stats_score.json\n{\n  "took" : 5,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 8,\n      "relation" : "eq"\n    },\n    "max_score" : null,\n    "hits" : [ ]\n  },\n  "aggregations" : {\n    "stats_score" : {\n      "count" : 8,\n      "min" : 8.0,\n      "max" : 27.0,\n      "avg" : 17.0,\n      "sum" : 136.0\n    }\n  }\n}\n')])])]),n("h3",{attrs:{id:"버킷-어그리게이션"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#버킷-어그리게이션"}},[t._v("#")]),t._v(" 버킷 어그리게이션")]),t._v(" "),n("p",[t._v("버킷 어그리게이션는 관계형 데이터베이스의 "),n("code",[t._v("Group by")]),t._v("와 유사하다. 버킷 어그리게이션을 사용하려면 매핑이 추가되어있어야 한다.")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// player_mapping.json")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"player"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"fielddata"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"fielddata"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"long"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"long"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"assist"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"long"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("   \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ curl -XPUT http://localhost:9200/person/player/_mapping?include_type_name=true&pretty \\\n-H 'Content-Type: application/json' \\\n-d @player_mapping.json\n")])])]),n("h4",{attrs:{id:"terms-aggregation"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#terms-aggregation"}},[t._v("#")]),t._v(" Terms aggregation")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// terms_aggs.json")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"size"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"aggs"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"player"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"terms"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"field"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nation"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$ curl -XGET http://localhost:9200/_search\\?pretty \\                                        \n-H \'Content-Type: application/json\' \\\n--data-binary @teams_aggs.json\n{\n  "took" : 89,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 8,\n      "relation" : "eq"\n    },\n    "max_score" : null,\n    "hits" : [ ]\n  },\n  "aggregations" : {\n    "player" : {\n      "doc_count_error_upper_bound" : 0,\n      "sum_other_doc_count" : 0,\n      "buckets" : [\n        {\n          "key" : "france",\n          "doc_count" : 3\n        },\n        {\n          "key" : "portugal",\n          "doc_count" : 2\n        },\n        {\n          "key" : "egypt",\n          "doc_count" : 1\n        },\n        {\n          "key" : "england",\n          "doc_count" : 1\n        },\n        {\n          "key" : "korea",\n          "doc_count" : 1\n        },\n        {\n          "key" : "south",\n          "doc_count" : 1\n        }\n      ]\n    }\n  }\n}\n')])])])])}),[],!1,null,null,null);a.default=e.exports}}]);